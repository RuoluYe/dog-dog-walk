{"ast":null,"code":"import { useState, useCallback, useEffect } from \"react\";\nlet logoutTimer;\nexport default function useAuth() {\n  const [token, setToken] = useState(false);\n  const [userId, setUserId] = useState(null);\n  const [tokenExpDate, setTokenExpDate] = useState(null);\n  const login = useCallback((userId, token, expDate) => {\n    const tokenExpDate = expDate || new Date(new Date().getTime() + 1000 * 60 * 60);\n    setToken(token);\n    setUserId(userId);\n    setTokenExpDate(tokenExpDate);\n    localStorage.setItem(\"user\", JSON.stringify({\n      userId,\n      token,\n      expiration: tokenExpDate.toISOString()\n    }));\n  }, []);\n  const logout = useCallback(() => {\n    setToken(null);\n    setUserId(null);\n    setTokenExpDate(null);\n    localStorage.removeItem(\"user\");\n  }, []);\n  useEffect(() => {\n    const data = JSON.parse(localStorage.getItem(\"user\"));\n    const tokenExpirationDate = data && new Date(data.expiration).getTime();\n    const now = new Date().getTime();\n    if (data && data.token && tokenExpirationDate > now) {\n      login(data.userId, data.token);\n    }\n  }, [login]);\n  useEffect(() => {\n    if (token && tokenExpDate) {\n      const remainingTime = tokenExpDate.getTime() - new Date().getTime();\n      logoutTimer = setTimeout(logout, remainingTime);\n    } else {\n      clearTimeout(logoutTimer);\n    }\n  }, [token, logout, tokenExpDate]);\n  return {\n    userId,\n    token,\n    login,\n    logout\n  };\n}","map":{"version":3,"names":["useState","useCallback","useEffect","logoutTimer","useAuth","token","setToken","userId","setUserId","tokenExpDate","setTokenExpDate","login","expDate","Date","getTime","localStorage","setItem","JSON","stringify","expiration","toISOString","logout","removeItem","data","parse","getItem","tokenExpirationDate","now","remainingTime","setTimeout","clearTimeout"],"sources":["C:/Users/yeruo/OneDrive - UW/Desktop/free-dog-walk/frontend/src/shared/hooks/auth-hook.js"],"sourcesContent":["import { useState, useCallback, useEffect } from \"react\";\n\nlet logoutTimer;\n\nexport default function useAuth() {\n  const [token, setToken] = useState(false);\n  const [userId, setUserId] = useState(null);\n  const [tokenExpDate, setTokenExpDate] = useState(null);\n\n  const login = useCallback((userId, token, expDate) => {\n    const tokenExpDate =\n      expDate || new Date(new Date().getTime() + 1000 * 60 * 60);\n\n    setToken(token);\n    setUserId(userId);\n    setTokenExpDate(tokenExpDate);\n\n    localStorage.setItem(\n      \"user\",\n      JSON.stringify({\n        userId,\n        token,\n        expiration: tokenExpDate.toISOString(),\n      })\n    );\n  }, []);\n\n  const logout = useCallback(() => {\n    setToken(null);\n    setUserId(null);\n    setTokenExpDate(null);\n\n    localStorage.removeItem(\"user\");\n  }, []);\n\n  useEffect(() => {\n    const data = JSON.parse(localStorage.getItem(\"user\"));\n\n    const tokenExpirationDate = data && new Date(data.expiration).getTime();\n    const now = new Date().getTime();\n\n    if (data && data.token && tokenExpirationDate > now) {\n      login(data.userId, data.token);\n    }\n  }, [login]);\n\n  useEffect(() => {\n    if (token && tokenExpDate) {\n      const remainingTime = tokenExpDate.getTime() - new Date().getTime();\n\n      logoutTimer = setTimeout(logout, remainingTime);\n    } else {\n      clearTimeout(logoutTimer);\n    }\n  }, [token, logout, tokenExpDate]);\n\n  return { userId, token, login, logout };\n}\n"],"mappings":"AAAA,SAASA,QAAQ,EAAEC,WAAW,EAAEC,SAAS,QAAQ,OAAO;AAExD,IAAIC,WAAW;AAEf,eAAe,SAASC,OAAOA,CAAA,EAAG;EAChC,MAAM,CAACC,KAAK,EAAEC,QAAQ,CAAC,GAAGN,QAAQ,CAAC,KAAK,CAAC;EACzC,MAAM,CAACO,MAAM,EAAEC,SAAS,CAAC,GAAGR,QAAQ,CAAC,IAAI,CAAC;EAC1C,MAAM,CAACS,YAAY,EAAEC,eAAe,CAAC,GAAGV,QAAQ,CAAC,IAAI,CAAC;EAEtD,MAAMW,KAAK,GAAGV,WAAW,CAAC,CAACM,MAAM,EAAEF,KAAK,EAAEO,OAAO,KAAK;IACpD,MAAMH,YAAY,GAChBG,OAAO,IAAI,IAAIC,IAAI,CAAC,IAAIA,IAAI,CAAC,CAAC,CAACC,OAAO,CAAC,CAAC,GAAG,IAAI,GAAG,EAAE,GAAG,EAAE,CAAC;IAE5DR,QAAQ,CAACD,KAAK,CAAC;IACfG,SAAS,CAACD,MAAM,CAAC;IACjBG,eAAe,CAACD,YAAY,CAAC;IAE7BM,YAAY,CAACC,OAAO,CAClB,MAAM,EACNC,IAAI,CAACC,SAAS,CAAC;MACbX,MAAM;MACNF,KAAK;MACLc,UAAU,EAAEV,YAAY,CAACW,WAAW,CAAC;IACvC,CAAC,CACH,CAAC;EACH,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMC,MAAM,GAAGpB,WAAW,CAAC,MAAM;IAC/BK,QAAQ,CAAC,IAAI,CAAC;IACdE,SAAS,CAAC,IAAI,CAAC;IACfE,eAAe,CAAC,IAAI,CAAC;IAErBK,YAAY,CAACO,UAAU,CAAC,MAAM,CAAC;EACjC,CAAC,EAAE,EAAE,CAAC;EAENpB,SAAS,CAAC,MAAM;IACd,MAAMqB,IAAI,GAAGN,IAAI,CAACO,KAAK,CAACT,YAAY,CAACU,OAAO,CAAC,MAAM,CAAC,CAAC;IAErD,MAAMC,mBAAmB,GAAGH,IAAI,IAAI,IAAIV,IAAI,CAACU,IAAI,CAACJ,UAAU,CAAC,CAACL,OAAO,CAAC,CAAC;IACvE,MAAMa,GAAG,GAAG,IAAId,IAAI,CAAC,CAAC,CAACC,OAAO,CAAC,CAAC;IAEhC,IAAIS,IAAI,IAAIA,IAAI,CAAClB,KAAK,IAAIqB,mBAAmB,GAAGC,GAAG,EAAE;MACnDhB,KAAK,CAACY,IAAI,CAAChB,MAAM,EAAEgB,IAAI,CAAClB,KAAK,CAAC;IAChC;EACF,CAAC,EAAE,CAACM,KAAK,CAAC,CAAC;EAEXT,SAAS,CAAC,MAAM;IACd,IAAIG,KAAK,IAAII,YAAY,EAAE;MACzB,MAAMmB,aAAa,GAAGnB,YAAY,CAACK,OAAO,CAAC,CAAC,GAAG,IAAID,IAAI,CAAC,CAAC,CAACC,OAAO,CAAC,CAAC;MAEnEX,WAAW,GAAG0B,UAAU,CAACR,MAAM,EAAEO,aAAa,CAAC;IACjD,CAAC,MAAM;MACLE,YAAY,CAAC3B,WAAW,CAAC;IAC3B;EACF,CAAC,EAAE,CAACE,KAAK,EAAEgB,MAAM,EAAEZ,YAAY,CAAC,CAAC;EAEjC,OAAO;IAAEF,MAAM;IAAEF,KAAK;IAAEM,KAAK;IAAEU;EAAO,CAAC;AACzC"},"metadata":{},"sourceType":"module"}